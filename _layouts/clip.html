<!DOCTYPE html>
<html>
  <head>
    <title>{{ page.title }}</title>
    <meta charset="utf-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta name="keywords" content="Michal T. Ruprecht, Michal Ruprecht">
    <meta content="Michal T. Ruprecht" name="author">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
      @import url('https://fonts.googleapis.com/css?family=Montserrat:400,400i,500,500i,600,600i,700,700i,800,800i,900,900i');
      @import url('https://fonts.googleapis.com/css?family=Merriweather:400,400i,500,500i,600,600i,700,700i,800,800i,900,900i');
    </style>

    <link rel="stylesheet" type="text/css" href="https://michalruprecht.github.io/med.css">
    <link rel="shortcut icon" async href="https://michalruprecht.github.io/assets/favicon.ico"/>
    <script src="https://michalruprecht.github.io/script.js"></script>

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-141229929-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-141229929-1');
    </script>
  </head>

  <body>
    <div class="container">
      <article class="clip-article">
        <section class="nyt-body">

          <!-- Top utility row -->
          <div class="clip-topbar">
            <div class="clip-published">
              {% if page.publisher %}
                Published on <span class="clip-publisher">{{ page.publisher }}</span>
              {% endif %}
            </div>

            <div class="clip-actions">
              {% if page.publisher_url %}
                <a class="filter-btn clip-action-btn" href="{{ page.publisher_url }}" target="_blank" rel="noopener">
                  Link to article
                </a>
              {% endif %}

              {% if page.pdf != false and page.clip_id %}
                {% assign cid = page.clip_id | to_s %}
                {% assign pdf_path = 'https://michalruprecht.com/pages/clips/assets/pdf/' | append: cid | append: '.pdf' %}
                <a class="filter-btn clip-action-btn" href="{{ pdf_path }}" target="_blank" rel="noopener">
                  PDF
                </a>
              {% endif %}
            </div>
          </div>

          <hr class="clip-divider">

          <!-- Headline -->
          <h1 class="nyt-title">{{ page.title }}</h1>

          <!-- MEDIA -->
          {% assign cid = page.clip_id | to_s %}

          {% if page.photo_story == true %}
            {%- comment -%}
              Photo story mode:
              - you provide photo_total (e.g., 6)
              - filenames are: 87.jpg, 87b.jpg, 87c.jpg...
              - captions + credits come from arrays: photo_captions_html, photo_credits
            {%- endcomment -%}

            {% assign letters = "b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z" | split: "," %}
            {% assign total = page.photo_total | default: 1 %}

            <div class="clip-photo-story">
              {% for i in (0..50) %}
                {% if i >= total %}{% break %}{% endif %}

                {% if i == 0 %}
                  {% assign suffix = "" %}
                {% else %}
                  {% assign idx = i | minus: 1 %}
                  {% assign suffix = letters[idx] %}
                {% endif %}

                {% assign img_path = 'https://michalruprecht.com/pages/clips/assets/photo/' | append: cid | append: suffix | append: '.jpg' %}

                <div class="clip-photo-block">
                  <img class="nyt-image clip-image" src="{{ img_path }}" alt="">
                  {% assign cap = page.photo_captions_html[i] %}
                  {% assign cred = page.photo_credits[i] %}
                  {% if cap or cred %}
                    <div class="clip-captionline">
                      {% if cap %}
                        <span class="nyt-image-caption">{{ cap }}</span>
                      {% endif %}
                      {% if cred %}
                        <span class="nyt-image-attribution"> {{ cred }}</span>
                      {% endif %}
                    </div>
                  {% endif %}
                </div>
              {% endfor %}
            </div>

          {% else %}
            <!-- Normal clip: ALWAYS show single image -->
            {% if page.clip_id %}
              {% assign img_path = 'https://michalruprecht.com/pages/clips/assets/photo/' | append: cid | append: '.jpg' %}
              <img class="nyt-image clip-image" src="{{ img_path }}" alt="">
            {% endif %}

            {% if page.caption_html or page.photo_credit %}
              <div class="clip-captionline">
                {% if page.caption_html %}
                  <span class="nyt-image-caption">{{ page.caption_html }}</span>
                {% endif %}
                {% if page.photo_credit %}
                  <span class="nyt-image-attribution"> {{ page.photo_credit }}</span>
                {% endif %}
              </div>
            {% endif %}
          {% endif %}

          <!-- Byline + date -->
          <div class="clip-meta">
            {% if page.byline %}
              <p class="nyt-byline">{{ page.byline }}</p>
            {% endif %}
            {% if page.date_display %}
              <p class="nyt-publish-date">{{ page.date_display }}</p>
            {% endif %}
          </div>

          <!-- Embed (if present) ALWAYS goes here: after date, before story -->
          {% if page.embed_html %}
            <div class="clip-embed">
              {{ page.embed_html }}
            </div>
          {% endif %}

          <!-- Story -->
          <div class="clip-body">
            {{ content }}
          </div>

          <div class="clip-bottom">
            <a href="https://michalruprecht.com/pages/clips" class="clip-return filter-btn">Return to clips</a>
          </div>

        </section>
      </article>
    </div>
  </body>
</html>
